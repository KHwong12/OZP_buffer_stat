import{aF as T,dk as L,dj as b,e as j,b4 as x,di as s,eM as O,dh as I,aY as k,aD as F,e7 as l}from"./index.c449ba0d.js";import{f as C}from"./sphere.f8db6816.js";import{c as a,r as z}from"./vectorStacks.fa4b7083.js";function R(r){const n=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],e=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],t=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(n,e,t))}function S(r,n){const e=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),t=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),u=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return T(r,e,t,u),r}function Y(r,n,e){Math.abs(r[0])>Math.abs(r[1])?T(n,0,1,0):T(n,1,0,0),L(e,r,n),b(n,n),L(n,e,r),b(e,e)}function V(r=E){return[r[0],r[1],r[2],r[3]]}function rr(r=E[0],n=E[1],e=E[2],t=E[3]){return v(r,n,e,t,z.get())}function D(r,n){return v(n[0],n[1],n[2],n[3],r)}function v(r,n,e,t,u=V()){return u[0]=r,u[1]=n,u[2]=e,u[3]=t,u}function H(r,n,e){const t=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],u=Math.abs(t-1)>1e-5&&t>1e-12?1/Math.sqrt(t):1;return e[0]=n[0]*u,e[1]=n[1]*u,e[2]=n[2]*u,e[3]=-(e[0]*r[0]+e[1]*r[1]+e[2]*r[2]),e}function J(r,n,e,t=V()){const u=e[0]-n[0],c=e[1]-n[1],o=e[2]-n[2],N=r[0]-n[0],_=r[1]-n[1],A=r[2]-n[2],g=c*A-o*_,d=o*N-u*A,p=u*_-c*N,P=g*g+d*d+p*p,X=Math.abs(P-1)>1e-5&&P>1e-12?1/Math.sqrt(P):1;return t[0]=g*X,t[1]=d*X,t[2]=p*X,t[3]=-(t[0]*r[0]+t[1]*r[1]+t[2]*r[2]),t}function K(r,n,e,t,u){if(r.count<3)return!1;r.getVec(e,h);let c=t,o=!1;for(;c<r.count-1&&!o;)r.getVec(c,M),c++,o=!l(h,M);if(!o)return!1;for(c=Math.max(c,u),o=!1;c<r.count&&!o;)r.getVec(c,f),c++,s($,h,M),b($,$),s(m,M,f),b(m,m),o=!l(h,f)&&!l(M,f)&&Math.abs(I($,m))<Q;return o?(J(h,M,f,n),!0):(e!==0||t!==1||u!==2)&&K(r,n,0,1,2)}const Q=.99619469809,h=F(),M=F(),f=F(),$=F(),m=F();function nr(r,n,e){return n!==r&&D(r,n),r[3]=-I(r,e),r}function er(r,n){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n}function tr(r,n,e,t){return L(f,n,r),H(e,f,t)}function ur(r,n,e,t){return q(r,n,s(a.get(),e,n),W,t)}function or(r,n,e){return!!j(n)&&q(r,n.origin,n.direction,Z,e)}function cr(r,n,e){return q(r,n.origin,n.vector,i.NONE,e)}function ir(r,n,e){return q(r,n.origin,n.vector,i.CLAMP,e)}function ar(r,n){return y(r,n)>=0}function fr(r,n){const e=I(r,n.ray.direction),t=-y(r,n.ray.origin);if(e>-1e-6&&e<1e-6)return t>0;const u=t/e;return e>0?u<n.c1&&(n.c1=u):u>n.c0&&(n.c0=u),n.c0<=n.c1}function Ir(r,n,e){const t=x(a.get(),r,-r[3]),u=U(r,s(a.get(),n,t),a.get());return O(e,u,t),e}function Nr(r,n,e,t){const u=r,c=a.get(),o=a.get();Y(u,c,o);const N=s(a.get(),e,n),_=C(c,N),A=C(o,N),g=C(u,N);return T(t,_,A,g)}function U(r,n,e){const t=x(a.get(),r,I(r,n));return s(e,n,t),e}function y(r,n){return I(r,n)+r[3]}function q(r,n,e,t,u){const c=I(r,e);if(c===0)return!1;let o=-(I(r,n)+r[3])/c;return t&i.CLAMP&&(o=k(o,0,1)),!(!(t&i.INFINITE_MIN)&&o<0||!(t&i.INFINITE_MAX)&&o>1)&&(O(u,n,x(u,e,o)),!0)}function Mr(r){return r}const E=[0,0,1,0];var i;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(i||(i={}));const W=i.INFINITE_MIN|i.INFINITE_MAX,Z=i.INFINITE_MAX;export{D as A,rr as E,v as F,fr as H,Ir as J,Nr as K,nr as L,tr as O,er as P,ir as U,ur as V,y as W,Mr as Z,H as _,S as a,K as b,J as j,R as l,V as p,or as q,cr as x,ar as z};
